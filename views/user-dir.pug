extends layout

append head
  title #{username} #{key} - #{course} - Omnivore

append content
  
  p.key: +keynav(key)
  
  if dirs.length
    table
      tbody
        each row in dirs
          tr
            td.bullet(data-dir=true)
            td.key: a(href=`/${course}/u/${username}${row.key}`): +key(path.relative(key, row.key))
  
  if children.length
    table
      tbody
        each row, idx in children
          if row.key.endsWith('-comment') && idx > 0 && row.key.startsWith(children[idx-1].key)
            tr.detail
              td.bullet(data-computed=row.computed)
              td.key
              td.value(data-type=types.which(row.value, types.value_types)): +value(row.value)
              td
              td
              td
              td.visible(data-on=row.visible)
              td.active(data-on=row.active)
              td: a(href=`/${course}/u/${username}${row.key}`) ...
          else
            tr
              td.bullet(data-computed=row.computed)
              td.key: +key(path.relative(key, row.key))
              td.value(data-type=types.which(row.value, types.value_types)): +value(row.value)
              td.ts: +ts(row.ts)
              td.due.ts(data-value=row.deadline): +ts(row.deadline)
              td.late(data-on=row.penalty_applied)
              td.visible(data-on=row.visible)
              td.active(data-on=row.active)
              td: a(href=`/${course}/u/${username}${row.key}`) ...
